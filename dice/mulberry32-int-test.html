<!doctype html>
<html>
<!-- SPDX-License-Identifier: MIT -->

<head>
  <title>rng Test</title>
  <style>
    #graph th {
      text-align: center;
    }

    #graph th:first-child {
      text-align: right;
    }

    #graph td {
      vertical-align: bottom;
      padding: 8px;
    }

    .results {
      display: inline-block;
      border: 1px solid blue;
    }
    #graph .result {
      display: inline-block;
      width: 2px;
      background-color: black;
      vertical-align: bottom;
    }
  </style>
</head>

<body>
  <div id="graph"></div>
  <script type="module">
import { RNGMulberry32 } from './random-number-generator-mulberry32.js';

const graph = document.getElementById('graph');
const runCount = 500000;
function scale(result){
  return Math.floor(result / 50) + 'px';
}
const max = 250;

const table = document.createElement('table');
graph.appendChild(table);

const header = document.createElement('tr');
table.appendChild(header);

const hSeed = document.createElement('th');
hSeed.appendChild(document.createTextNode('Seed'));
header.appendChild(hSeed);

const hInt = document.createElement('th');
hInt.appendChild(document.createTextNode('rng.int'));
header.appendChild(hInt);

const hNormalInt = document.createElement('th');
hNormalInt.appendChild(document.createTextNode('rng.normalInt'));
header.appendChild(hNormalInt);

const seeds = [null, null, null, null, null, 1234, 1234, 1, 2, 3, 4];

seeds.forEach(seed => {
  const row = document.createElement('tr');
  table.appendChild(row);

  const cSeed = document.createElement('th');
  cSeed.appendChild(document.createTextNode(seed === null ? 'Random' : seed));
  row.appendChild(cSeed);

  const intRNG = new RNGMulberry32(seed);
  const intResults = [];
  for ( let i = 0; i < runCount; i++ ) {
    const value = intRNG.int(0, max);
    intResults[value] = (intResults[value]||0) + 1;
  }

  const normalIntRNG = new RNGMulberry32(seed);
  const normalIntResults = [];
  for ( let i = 0; i < runCount; i++ ) {
    const value = normalIntRNG.normalInt(0, max);
    normalIntResults[value] = (normalIntResults[value]||0) + 1;
  }

  const cInt = document.createElement('td');
  const cIntResults = document.createElement('div');
  cIntResults.classList.add('results');
  intResults.forEach(result => {
    const resDiv = document.createElement('div');
    resDiv.classList.add('result');
    resDiv.style.height = scale(result);
    cIntResults.appendChild( resDiv );
  });
  cInt.appendChild( cIntResults );
  row.appendChild(cInt);

  const cNormalInt = document.createElement('td');
  const cNormalIntResults = document.createElement('div');
  cNormalIntResults.classList.add('results');
  normalIntResults.forEach(result => {
    const resDiv = document.createElement('div');
    resDiv.classList.add('result');
    resDiv.style.height = scale(result);
    cNormalIntResults.appendChild( resDiv );
  });
  cNormalInt.appendChild( cNormalIntResults );
  row.appendChild(cNormalInt);
});

  </script>
</body>

</html>
